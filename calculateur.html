<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Calculateur d'alcool√©mie ‚Äî ADN66</title>
  <meta name="description" content="Estimation indicative d'alcool√©mie. Ne remplace pas un √©thylotest homologu√©." />

  <style>
    :root{
      --bg:#050b12;
      --panel:#0b1420;
      --panel2:#0e1826;
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --muted2:rgba(255,255,255,.56);
      --border:rgba(255,255,255,.10);
      --glow:rgba(84,180,255,.22);
      --ok:rgba(33,208,122,.18);
      --warn:rgba(255,204,51,.18);
      --danger:rgba(255,77,77,.18);
      --ok2:#21d07a;
      --warn2:#ffcc33;
      --danger2:#ff4d4d;
      --btn:#122538;
      --btn2:#17314b;
    }

    html,body{height:100%;}
    body{
      margin:0;
      background: radial-gradient(1200px 700px at 15% 10%, rgba(84,180,255,.10), transparent 55%),
                  radial-gradient(900px 600px at 85% 20%, rgba(80,255,170,.08), transparent 60%),
                  var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    *, *:before, *:after{box-sizing:border-box;}
    button, input{font:inherit;}
    button{touch-action:manipulation;}

    .wrap{
      max-width:520px;
      margin:0 auto;
      padding:16px 14px 18px;
    }

    header{
      display:flex;
      align-items:flex-start;
      gap:12px;
      margin-bottom:12px;
    }
    .badge{
      width:44px;height:44px;
      border-radius:16px;
      border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: 0 0 0 1px rgba(84,180,255,.08) inset, 0 18px 70px rgba(0,0,0,.55);
      display:flex;
      align-items:center;
      justify-content:center;
      color:rgba(255,255,255,.86);
      flex:0 0 auto;
    }
    h1{
      font-size:26px;
      line-height:1.12;
      margin:0;
      letter-spacing:.2px;
    }
    .sub{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13.5px;
      line-height:1.35;
    }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.08);
      border-radius:22px;
      padding:14px;
      box-shadow: 0 18px 90px rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .row{display:flex; gap:10px;}
    .row + .row{margin-top:12px;}
    .row label{
      display:block;
      color:var(--muted);
      font-size:13px;
      margin:0 0 8px 2px;
    }

    .seg{
      display:flex;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:6px;
      gap:6px;
    }
    .seg button{
      flex:1;
      border:1px solid transparent;
      background:transparent;
      color:rgba(255,255,255,.82);
      padding:12px 12px;
      border-radius:14px;
      font-weight:700;
      cursor:pointer;
    }
    .seg button.active{
      background:linear-gradient(180deg, rgba(84,180,255,.25), rgba(84,180,255,.10));
      border-color:rgba(84,180,255,.35);
      box-shadow: 0 0 0 1px rgba(84,180,255,.12) inset, 0 14px 40px rgba(0,0,0,.45);
    }

    input{
      width:100%;
      background:rgba(0,0,0,.30);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:14px 14px;
      color:var(--text);
      outline:none;
    }
    input:focus{
      border-color:rgba(84,180,255,.45);
      box-shadow:0 0 0 4px rgba(84,180,255,.12);
    }

    .hint{
      margin-top:10px;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    .actions{
      margin-top:14px;
      display:flex;
      gap:10px;
    }
    .btn{
      border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(18,37,56,.95), rgba(11,20,32,.95));
      color:rgba(255,255,255,.92);
      padding:14px 14px;
      border-radius:18px;
      font-weight:800;
      cursor:pointer;
      flex:1;
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
    }
    .btn.primary{
      background:linear-gradient(180deg, rgba(23,49,75,.98), rgba(12,26,40,.98));
      border-color: rgba(84,180,255,.25);
      box-shadow: 0 0 0 1px rgba(84,180,255,.10) inset, 0 18px 70px rgba(0,0,0,.55);
    }

    .resultWrap{margin-top:14px; display:none;}
    .resultWrap.show{display:block;}

    .resultTop{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
      padding:12px 14px;
      border-radius:20px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.25);
    }
    .big{
      font-size:40px;
      line-height:1;
      font-weight:900;
      letter-spacing:.4px;
    }
    .meta{
      text-align:right;
      color:var(--muted);
      font-size:13px;
      line-height:1.3;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
      font-weight:800;
      font-size:12.5px;
      color:rgba(255,255,255,.86);
      white-space:nowrap;
    }

    .box{
      margin-top:10px;
      padding:12px 12px;
      border-radius:20px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.20);
    }
    .box h3{
      margin:0 0 8px;
      font-size:15px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .box ul{margin:0; padding-left:18px; color:rgba(255,255,255,.88);}
    .box li{margin:6px 0; color:rgba(255,255,255,.86); font-size:13.5px; line-height:1.35;}
    .box .note{
      margin-top:10px;
      color:var(--muted2);
      font-size:12.5px;
      line-height:1.35;
    }

    .tone-ok{border-color:rgba(33,208,122,.28); background:linear-gradient(180deg, var(--ok), rgba(0,0,0,.18));}
    .tone-warn{border-color:rgba(255,204,51,.30); background:linear-gradient(180deg, var(--warn), rgba(0,0,0,.18));}
    .tone-danger{border-color:rgba(255,77,77,.30); background:linear-gradient(180deg, var(--danger), rgba(0,0,0,.18));}

    .tone-ok .big{color:var(--ok2);}
    .tone-warn .big{color:var(--warn2);}
    .tone-danger .big{color:var(--danger2);}

    .fine{
      margin-top:14px;
      color:rgba(255,255,255,.60);
      font-size:12.5px;
      text-align:center;
      line-height:1.35;
    }

    /* EMBED MODE: hide top header + footer text to fit in iframe popup */
    body.embed header{display:none;}
    body.embed .fine{display:none;}
    body.embed .wrap{padding:12px 12px 16px;}
    body.embed .card{border-radius:22px;}
    body.embed .btn{border-radius:18px;}
    @media (max-width:420px){
      h1{font-size:24px;}
      .big{font-size:36px;}
      .wrap{padding:14px 12px 16px;}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="badge">üß™</div>
      <div>
        <h1>Calculateur d‚Äôalcool√©mie</h1>
        <p class="sub">Estimation indicative ‚Ä¢ ne remplace pas un √©thylotest homologu√©</p>
      </div>
    </header>

    <div class="card" id="card">
      <div class="row">
        <div style="flex:1;">
          <label>Sexe</label>
          <div class="seg" role="tablist" aria-label="Sexe">
            <button id="btnH" class="active" type="button" role="tab" aria-selected="true">Homme</button>
            <button id="btnF" type="button" role="tab" aria-selected="false">Femme</button>
          </div>
        </div>
      </div>

      <div class="row">
        <div style="flex:1;">
          <label for="poids">Poids (kg)</label>
          <input id="poids" inputmode="decimal" placeholder="Ex : 75" />
        </div>
      </div>

      <div class="row">
        <div style="flex:1;">
          <label for="verres">Nombre de verres</label>
          <input id="verres" inputmode="decimal" placeholder="Ex : 3" />
          <div class="hint">1 verre ‚Äústandard‚Äù ‚âà 10 g d‚Äôalcool (bi√®re 25 cl, vin 10 cl, spiritueux 3 cl).</div>
        </div>
      </div>

      <div class="actions">
        <button class="btn primary" type="button" id="calcBtn">Calculer</button>
      </div>

      <div class="resultWrap" id="resultWrap" aria-live="polite">
        <div class="resultTop" id="resultTop">
          <div>
            <div class="big" id="bigValue">‚Äî g/L</div>
            <div class="pill" id="badgePill">‚Äî</div>
          </div>
          <div class="meta">
            <div><strong>Taux estim√©</strong> : <span id="tauxInline">‚Äî</span></div>
            <div><strong>√âlimination estim√©e</strong> : <span id="elimInline">‚Äî</span></div>
          </div>
        </div>

        <div class="box" id="boxSituation">
          <h3>Votre situation <span class="pill" id="pillSituation">‚Äî</span></h3>
          <ul id="listSituation"></ul>
        </div>

        <div class="box" id="boxJuridique">
          <h3>Cons√©quences juridiques <span class="pill" id="pillJuridique">‚Äî</span></h3>
          <ul id="listJuridique"></ul>
        </div>

        <div class="box" id="boxConseil">
          <h3>Conseil s√©curit√© <span class="pill" id="pillConseil">‚Äî</span></h3>
          <ul id="listConseil"></ul>
          <div class="note">Estimation indicative : seul un √©thylotest homologu√© donne un taux r√©el.</div>
        </div>
      </div>

      <div class="box" style="margin-top:14px;">
        <h3 style="margin:0; font-size:14.5px;">‚ö†Ô∏è Information</h3>
        <div style="color:rgba(255,255,255,.78); font-size:13.5px; line-height:1.4; margin-top:8px;">
          Cet outil n‚Äôest pas une autorisation √† prendre la route. En cas de doute : ne conduisez pas.
        </div>
      </div>
    </div>

    <div class="fine">L‚Äôabus d‚Äôalcool est dangereux pour la sant√©. √Ä consommer avec mod√©ration.</div>
  </div>

  <script>
    // Detect embed mode (iframe or ?embed=1)
    function isInIframe(){ try { return window.self !== window.top; } catch(e){ return true; } }
    const qs = new URLSearchParams(location.search);
    const EMBED = (qs.get("embed") === "1") || isInIframe();
    if (EMBED) document.body.classList.add("embed");

    // State
    let coef = 0.68; // Homme
    const GRAMS_PER_GLASS = 10; // standard
    const ELIM_PER_HOUR = 0.15; // g/L per hour (indicative)

    // Elements
    const btnH = document.getElementById('btnH');
    const btnF = document.getElementById('btnF');
    const poids = document.getElementById('poids');
    const verres = document.getElementById('verres');
    const calcBtn = document.getElementById('calcBtn');

    const resultWrap = document.getElementById('resultWrap');
    const resultTop = document.getElementById('resultTop');
    const bigValue = document.getElementById('bigValue');
    const badgePill = document.getElementById('badgePill');

    const tauxInline = document.getElementById('tauxInline');
    const elimInline = document.getElementById('elimInline');

    const boxSituation = document.getElementById('boxSituation');
    const boxJuridique = document.getElementById('boxJuridique');
    const boxConseil = document.getElementById('boxConseil');

    const pillSituation = document.getElementById('pillSituation');
    const pillJuridique = document.getElementById('pillJuridique');
    const pillConseil = document.getElementById('pillConseil');

    const listSituation = document.getElementById('listSituation');
    const listJuridique = document.getElementById('listJuridique');
    const listConseil = document.getElementById('listConseil');

    function setSex(sex){
      if(sex === 'H'){
        coef = 0.68;
        btnH.classList.add('active'); btnH.setAttribute('aria-selected','true');
        btnF.classList.remove('active'); btnF.setAttribute('aria-selected','false');
      } else {
        coef = 0.55;
        btnF.classList.add('active'); btnF.setAttribute('aria-selected','true');
        btnH.classList.remove('active'); btnH.setAttribute('aria-selected','false');
      }
    }

    btnH.addEventListener('click', ()=> setSex('H'));
    btnF.addEventListener('click', ()=> setSex('F'));

    function toFixedFr(n, digits){
      const s = n.toFixed(digits);
      return s.replace('.', ',');
    }

    function formatElim(hours){
      // hours can be huge; display h + min
      const h = Math.floor(hours);
      const m = Math.round((hours - h) * 60);
      if (h <= 0) return m + " min";
      return h + " h " + String(m).padStart(2,'0') + " min";
    }

    function clearList(ul){ ul.innerHTML = ""; }
    function addItem(ul, text){
      const li = document.createElement('li');
      li.textContent = text;
      ul.appendChild(li);
    }

    function applyTone(tone){
      resultTop.classList.remove('tone-ok','tone-warn','tone-danger');
      boxSituation.classList.remove('tone-ok','tone-warn','tone-danger');
      boxJuridique.classList.remove('tone-ok','tone-warn','tone-danger');
      boxConseil.classList.remove('tone-ok','tone-warn','tone-danger');

      resultTop.classList.add(tone);
      boxSituation.classList.add(tone);
      boxJuridique.classList.add(tone);
      boxConseil.classList.add(tone);
    }

    function compute(){
      const p = parseFloat(String(poids.value).replace(',', '.'));
      const v = parseFloat(String(verres.value).replace(',', '.'));

      if(!p || p <= 0 || !v || v <= 0){
        // Minimal feedback: focus first missing field
        if(!p || p <= 0) poids.focus();
        else verres.focus();
        return;
      }

      const grams = v * GRAMS_PER_GLASS;
      const taux = grams / (p * coef); // simple Widmark-ish
      const hours = Math.max(0, taux / ELIM_PER_HOUR);

      // Render top
      bigValue.textContent = toFixedFr(taux, 2) + " g/L";
      badgePill.textContent = "Donn√©es estim√©es";
      tauxInline.textContent = toFixedFr(taux, 2) + " g/L";
      elimInline.textContent = formatElim(hours);

      // Decide level
      clearList(listSituation);
      clearList(listJuridique);
      clearList(listConseil);

      if(taux < 0.5){
        applyTone('tone-ok');
        pillSituation.textContent = "< 0,5 g/L";
        pillJuridique.textContent = "Sous le seuil";
        pillConseil.textContent = "Pr√©vention";
        addItem(listSituation, "Vous √™tes en dessous du seuil l√©gal g√©n√©ral (0,5 g/L).");
        addItem(listSituation, "Restez prudent : l‚Äôalcool alt√®re vigilance et r√©flexes.");
        addItem(listJuridique, "Aucune sanction li√©e au seuil g√©n√©ral si le taux reste inf√©rieur √† 0,5 g/L.");
        addItem(listJuridique, "En cas d‚Äôaccident, la responsabilit√© peut √™tre engag√©e selon les circonstances.");
        addItem(listConseil, "√âvitez de reprendre le volant si vous vous sentez fatigu√© ou diminu√©.");
        addItem(listConseil, "Attendez davantage ou faites-vous raccompagner si vous avez un doute.");
      } else if(taux < 0.8){
        applyTone('tone-warn');
        pillSituation.textContent = "0,5‚Äì0,79 g/L";
        pillJuridique.textContent = "Contravention";
        pillConseil.textContent = "Risque";
        addItem(listSituation, "Vous d√©passez le seuil l√©gal g√©n√©ral (0,5 g/L).");
        addItem(listSituation, "Risque important pour vous et les autres : ne conduisez pas.");
        addItem(listJuridique, "Sanctions possibles : amende (forfaitaire), retrait de points.");
        addItem(listJuridique, "Contr√¥les routiers : immobilisation du v√©hicule possible.");
        addItem(listConseil, "Ne reprenez pas le volant : taxi / VTC / raccompagnement.");
        addItem(listConseil, "Attendez la baisse du taux (estimatif) avant toute conduite.");
      } else {
        applyTone('tone-danger');
        pillSituation.textContent = "‚â• 0,8 g/L";
        pillJuridique.textContent = "D√©lit";
        pillConseil.textContent = "Urgent";
        addItem(listSituation, "Vous √™tes au-dessus du seuil d√©lit (0,8 g/L).");
        addItem(listSituation, "Interdiction absolue de conduire.");
        addItem(listJuridique, "Sanctions possibles : amende jusqu‚Äô√† 4 500 ‚Ç¨.");
        addItem(listJuridique, "Retrait de 6 points.");
        addItem(listJuridique, "Suspension / annulation du permis possible.");
        addItem(listJuridique, "Peine de prison possible selon les circonstances.");
        addItem(listConseil, "Demandez de l‚Äôaide imm√©diatement.");
        addItem(listConseil, "Choisissez un transport s√ªr : raccompagnement / taxi / VTC.");
      }

      resultWrap.classList.add('show');
      // scroll to result in iframe
      resultWrap.scrollIntoView({behavior:'smooth', block:'start'});
    }

    calcBtn.addEventListener('click', compute);

    // Enter to compute
    [poids, verres].forEach((el)=>{
      el.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){ e.preventDefault(); compute(); }
      });
    });
  </script>
</body>
</html>
